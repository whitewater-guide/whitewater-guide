FROM node:8

ENV PROJECT_ROOT /opt/app

RUN mkdir -p /tmp/app \
 && mkdir -p /opt/app \
 && chown -R node /opt/app

RUN npm install -g chokidar-cli pm2

COPY package.json yarn.lock /tmp/app/

RUN cd /tmp/app/ && yarn install

WORKDIR $PROJECT_ROOT

COPY bin /opt/bin

CMD ["/opt/bin/start_dev.sh"]
